"0","create_detection_matrix <- function(anno, sessione) {"
"0","    # Seleziona l'anno e la sessione dai file di occasioni e catture"
"0","    print(paste0(anno, "" - "",sessione))"
"0","    Datioccas_ <- Datioccas[Datioccas$Anno == anno & Datioccas$sessione == sessione ,]"
"0","    Daticatt_ <- Daticatt[Daticatt$Anno == anno & Daticatt$sessione == sessione ,]"
"0","    if (nrow(Datioccas_) == 0 | nrow(Daticatt_) == 0) {"
"0","        print(""Dati non disponibili."")"
"0","        return(NULL)"
"0","    }"
"0","    "
"0","    # Crea un dataframe vuoto in cui inserire la relazione tra occasioni e trappole"
"0","    print(max(Datioccas_$occasione))"
"0","    occupancy_ncols <- max(Datioccas_$occasione) + 1"
"0","    #occupancy_nrows <- max(Datioccas_$trappole.posizionate)"
"0","    #occupancy_nrows <- nrow(1:75)"
"0","    m <- matrix(0, ncol = occupancy_ncols, nrow = 75)"
"0","    occupancy_occasioni <- data.frame(m)"
"0","    "
"0","    # Da un nome ad ogni variabile occasione ed aggiunge la variabile ID_TRAP"
"0","    colnames(occupancy_occasioni) <- c(""ID_TRAP"",paste0(""occ "", 1:max(Datioccas_$occasione)))"
"0","    occupancy_occasioni$ID_TRAP <- seq.int(nrow(occupancy_occasioni))"
"0","    "
"0","    # Riempi la matrice con i valori dicotomici (1 indica almeno una cattura, 0 indica l'assenza di catture)"
"0","    for (cattura in c(1:nrow(Daticatt_))) {"
"0","        trappola <- as.numeric(as.character(Daticatt_[cattura,]$ID_TRAPPOLA))"
"0","        occasione <- Daticatt_[cattura,]$occasione"
"0","        "
"0","        occupancy_occasioni[trappola, paste0(""occ "", occasione)] <- 1"
"0","    }"
"0","    result <- occupancy_occasioni"
"0","}"
